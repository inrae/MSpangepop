# Generate structural variants in a population
With a population generated by msprime (or any VCF), generate structural variants with VISOR and obtain a final VCF with structural variant sequences and population genotypes.

Help for commands is available:
```bash
python tree_generation.py -h
python variants_generation.py -h
```

# ! DOC IS NOT UPDATED

## 1. Use a VCF as a base
A VCF is used as a base for genotypes and the position and number of variants. This VCF can be create with `msprime` to generate a population with:
```bash
python tree_generation.py -fai <FAI> -p <POPULATION SIZE> -r <MUTATION RATE> -n <SAMPLE SIZE>
```
This command output as many VCF as there are chromosomes in the reference FAI.

## 2. Generate structural variants
```bash
python variants_generation.py -fai <FAI> -fa <FASTA> -v <VCF> -y <YAML>
```
The VCF is the one created with the previous command using `msprime`.
YAML template is available in `VISOR_random_bed` folder. Modify the YAML input to set the percentage of each variant you want to simulate (must equal 100).

Each variant type has a size distribution file (bins = 100 bp) in folder `sv_distributions`. The data was extracted from [An integrated map of structural variation in 2,504 human genomes (Sudmant, et al. 2015)](https://www.nature.com/articles/nature15394).

The distributions are used to randomly sample each structural variant size.

# TODO
- [ ] Add non supported VISOR variant types
    - [ ] MNP
    - [ ] tandem repeat contraction
    - [ ] tandem repeat expansion
    - [ ] approximate tandem repetition
- [x] Add VCF merging when there are multiple chromosomes